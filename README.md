# webshop-eb

PrestaShop 1.7.8.x project deployed using Docker Compose with environment variable configuration.

## Requirements

- Docker
- Docker Compose
- Git

## Project Structure

```
webshop-eb/
├── README.md                          # This file
├── .env.dev                           # Environment variables (unchanged)
├── prestashop/
│   ├── docker-compose.yml             # Services configuration
│   ├── docker_run.sh                  # PrestaShop installation script
│   ├── setup.sh                       # Configuration script
│   ├── gen-cert.sh                    # SSL certificate generator
│   ├── Docker/
│   │   └── prestashop/
│   │       └── Dockerfile             # PrestaShop image
│   ├── nginx/
│   │   ├── dev.conf                   # NGINX configuration
│   │   └── ssl/                       # SSL certificates
│   └── src/                           # PrestaShop source code
```

## Quick Start

### 1. Clone the Repository

```bash
git clone git@github.com:skykuba/webshop-eb.git
cd webshop-eb/prestashop
```

### 2. Generate SSL Certificates (first time only)

```bash
./gen-cert.sh
```

### 3. Start the Project

The entire setup is run using environment variables from the `.env.dev` file:

```bash
docker compose -f docker-compose.yml up --build
```

Alternatively, to run in the background:

```bash
docker compose -f docker-compose.yml up -d --build
```

**What happens:**
- Variables from `.env.dev` are automatically loaded
- MySQL database is initialized
- PrestaShop is automatically installed
- NGINX starts with SSL
- phpMyAdmin is available for database management

## Environment Variables (.env.dev)

The `.env.dev` file contains all necessary configurations and **remains unchanged** between runs:

```env
# PrestaShop Configuration
PS_SHOP_NAME=tuttu
PS_ADMIN_MAIL=admin@gmial.com
PS_ADMIN_PASSWD=AdminPassword123
PS_LANGUAGE=pl
PS_COUNTRY=pl

# Database
DB_NAME=prestashop
DB_SERVER=some-mysql
DB_PORT=3306
DB_USER=root
DB_PREFIX=ps_
DB_ROOT_PASSWORD=admin

# Installation
PS_ERASE_DB=1
PS_INSTALL_DB=1
PS_DB_CREATE=1

# Security
PS_SSL=1
PS_FOLDER_ADMIN=admin4577
PS_FOLDER_INSTALL=install4577

# Other
PS_NEWSLETTER=0
```

**Important:** Do not edit this file for each run. Variables are set to stable, working values.

## Service Access

### PrestaShop Frontend

- **HTTPS:** https://localhost (self-signed certificate)

### Admin Panel

- **URL:** http://localhost/admin4577
- **Email:** `admin@gmial.com`
- **Password:** `AdminPassword123`

### phpMyAdmin

- **URL:** http://localhost:8081
- **Server:** `some-mysql`
- **Username:** `root`
- **Password:** `admin`

## Operational Commands

### Starting Services

```bash
# With logs (recommended for first run)
docker compose -f docker-compose.yml up --build

# In background (detached mode)
docker compose -f docker-compose.yml up -d --build
```

### Managing Services

```bash
# View running services
docker compose ps

# View logs
docker compose logs -f

# View logs from specific service
docker compose logs -f prestashop
docker compose logs -f some-mysql
docker compose logs -f nginx

# Stop services
docker compose down

# Stop and remove data (clean reset)
docker compose down -v
```

### Accessing Containers

```bash
# Access PrestaShop container
docker exec -it prestashop bash

# Access MySQL container
docker exec -it some-mysql bash

# Access NGINX container
docker exec -it nginx bash
```

## Usage Examples

### Scenario 1: First Run

```bash
cd webshop-eb/prestashop
./gen-cert.sh
docker compose -f docker-compose.yml up --build
# Wait for "PrestaShop successfully installed"
# Open https://localhost in your browser
```

### Scenario 2: Restart (without rebuild)

```bash
cd webshop-eb/prestashop
docker compose -f docker-compose.yml up
# Services start faster without rebuild
```

### Scenario 3: Clean Reset

```bash
cd webshop-eb/prestashop
docker compose down -v
./setup.sh
docker compose -f docker-compose.yml up --build
# All data is removed, fresh installation
```


## Notes

- **Environment variables** in `.env.dev` are set to sensible values and require no changes
- **SSL certificates** are self-signed and browser warnings are normal for development
- **Database data** is stored in a Docker volume and survives restarts (unless you use `down -v`)
- **PrestaShop code** is installed in `/prestashop/src/`

## Support

If you encounter issues, check:
1. Docker logs: `docker compose logs -f`
2. Container status: `docker compose ps`
3. Port availability: `docker ps -a`

